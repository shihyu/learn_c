<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>

<!-- Mirrored from openhome.cc/Gossip/CGossip/StructABC.html by HTTrack Website Copier/3.x [XR&CO'2008], Sun, 28 Jul 2013 09:08:06 GMT -->
<head>












  
  
  
  
  
  
  
  
  
  
  
  <link rel="stylesheet" href="css/stdlayout.css" type="text/css">












  
  
  
  
  
  
  
  
  
  
  
  <link rel="stylesheet" href="css/print.css" type="text/css">












  
  
  
  
  
  
  
  
  
  
  
  <meta content="text/html; charset=Big5" http-equiv="content-type">











  
  
  
  
  
  
  
  
  
  
  
  <title>struct 簡介</title>
</head>


<body>












<h3><a href="../index.html">From
Gossip@Openhome</a></h3>












<h1><a href="index.html">C&nbsp;Gossip: struct 簡介</a></h1>












<table style="text-align: left; width: 946px; height: 32px;" border="0" cellpadding="0" cellspacing="0">












  <tbody>












    <tr>












      <td style="width: 676px; vertical-align: top;"> <small>struct
是C中用來包裝資料的關鍵字，當您使用struct來包資料時，您考慮這些件可能擁有的相關性，將之包裝在一起，例如學生會有學號、姓名、住址、電話等，
您可以使用struct來定義一個Student型態，這個型態中包括了學號、姓名、住址、電話等資訊，接著您可以使用Student來宣告新的資料，進
行資料指定或取出等。<br>






      <br>







舉個實例來說，您可以定義一個「球」的模子，考慮球有各種不同的顏色，以及球最基本的球半徑資訊，您想到這些資訊應該可以定義一個Ball資料型態並從中取得，當您在C中要包裝這些資訊時，您可以如下進行定義： <br>




      </small>
      
      
      
      
      <ul>




        <li><small>CustomType.h</small></li>




      
      
      
      
      </ul>




      
      
      
      
      <pre>struct Ball {<br>    char color[10];<br>    double radius;<br>};</pre>











      <span class="postbody"><br>




      </span><small>struct是C中用來定義struct的關鍵字，Ball是自定義的資料型態名稱： <br>






      </small>
      
      
      
      
      
      
      <div style="margin-left: 40px;"><small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">struct Ball { </span><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">







      <span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp;
&nbsp; //
成員定義</span><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">







      <span style="font-weight: bold; font-family: Courier New,Courier,monospace;">};</span><br>







      </small></div>







      <small><br>







最重要的是別忘了在最後加上分號，初學C的新手很常犯這個錯誤；接下來如果要使用這個Ball的話，可以如下建立實例並初始化：<br>




      </small>
      
      
      
      
      <div style="margin-left: 40px;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">struct Ball ball1 = {"red", 5.0};</span></small><br>




      </div>




      <small>

      <br>




這樣的話，ball1將包括color與radius兩個資料成員，以上的寫法將color成員初始化為"red"，而radius初始化為5.0，您也可以先宣告，後來再設定成員資料，例如：<br>




      </small>
      
      
      
      
      <div style="margin-left: 40px;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">struct Ball ball2;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">




      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">strcpy(ball2.color, "green");</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">




      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">ball2.radius = 10.0;</span></small><br>




      </div>




      <small><br>



在存取struct成員時，必須透過所宣告的名稱加上 <span style="font-weight: bold;">.</span> 運算子，以下寫個示範程式，看看Ball的使用：<br>




      </small>
      
      
      
      
      <ul>




        <li>main.c</li>




      
      
      
      
      </ul>




      
      
      
      
      <pre>#include &lt;stdio.h&gt;<br>#include &lt;string.h&gt;<br>#include "CustomType.h"<br><br>int main(void) {<br>    struct Ball ball1 = {"red", 5.0};<br><br>    struct Ball ball2;<br>    strcpy(ball2.color, "green");<br>    ball2.radius = 10.0;<br>    <br>    printf("ball1: %s,\t%.2f\n", ball1.color, ball1.radius);<br>    printf("ball2: %s,\t%.2f\n", ball2.color, ball2.radius);    <br>            <br>    return 0;<br>}</pre>




      <small><br>




      </small><small><span class="postbody">
執行結果：</span></small><br>







      
      
      
      
      
      
      <table style="text-align: left; width: 100%;" border="0" cellpadding="2" cellspacing="2">







        <tbody>







          <tr>







            <td style="background-color: rgb(0, 0, 0);"><small><span style="color: rgb(255, 255, 255);">ball1: red,&nbsp;&nbsp;&nbsp;&nbsp; 5.00<br>




ball2: green,&nbsp;&nbsp; 10.00</span></small><span style="color: rgb(255, 255, 255);"><br>







            </span></td>







          </tr>







        
        
        
        
        
        
        </tbody>
      
      
      
      
      
      
      </table>







      <br>



      <small>您也可以在定義struct時，直接宣告struct實例，例如：<br>




      </small>
      
      
      
      
      <div style="margin-left: 40px;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">struct Ball {</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">



      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; char color[10];</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">



      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; double radius;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">



      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">} ball1 = {"red", 5.0}, ball2;</span></small><br>



      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;"></span></small></div>




      
      
      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;"><br>



      </span></small><small>如果要宣告struct陣列並初始化每個結構成員，則可以如下：<br>



      </small>
      
      
      
      <div style="margin-left: 40px;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">struct Ball balls[] = {{"red", 3.0}, </span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">



      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
{"green", 5.0}, </span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">



      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
{"blue", 10.0}};<br>



      <br style="font-weight: bold; font-family: Courier New,Courier,monospace;">



      </span></small><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">int
i;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">



      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">for(i = 0; i &lt; 3; i++) {</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">



      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; printf("ball1: %s,\t%.2f\n", balls[i].color, balls[i].radius);</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">



      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">}</span></small><br>



      </div>



      <small><br>




為了方便起見，您可以使用typedef定義structs的名稱，如此一來，宣告並產生實例時，就不用再寫struct關鍵字，例如：<br>




      </small>
      
      
      
      
      <pre>#include &lt;stdio.h&gt;<br>#include &lt;string.h&gt;<br><br>struct Ball {<br>    char color[10];<br>    double radius;<br>};<br><span style="font-weight: bold;">typedef struct Ball CBall;</span><br><br>int main(void) {<br>    <span style="font-weight: bold;">CBall</span> ball1 = {"red", 5.0};<br><br>    <span style="font-weight: bold;">CBall</span> ball2;<br>    strcpy(ball2.color, "green");<br>    ball2.radius = 10.0;<br>    <br>    printf("ball1: %s,\t%.2f\n", ball1.color, ball1.radius);<br>    printf("ball2: %s,\t%.2f\n", ball2.color, ball2.radius);    <br><br>    return 0;<br>}</pre>




      <span class="postbody"><br>

      <small>或者是這樣重新命名：<br>

      </small></span>
      
      <div style="margin-left: 40px;"><span style="font-family: Courier New,Courier,monospace;" class="postbody"><small><span style="font-weight: bold;">typedef struct {</span></small></span><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">

      <span style="font-family: Courier New,Courier,monospace;" class="postbody"><small><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; char color[10];</span></small></span><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">

      <span style="font-family: Courier New,Courier,monospace;" class="postbody"><small><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; double radius;</span></small></span><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">

      <span style="font-family: Courier New,Courier,monospace;" class="postbody"><small><span style="font-weight: bold;">} Ball;</span></small></span><br>

      <span class="postbody"></span></div>

      <span class="postbody"><br>




      <small>您可以直接使用指定運算子，將一個struct的實例指定給另一個實例，這會將struct實例的成員值，一個一個「複製」給另一個被指定的對象，例如：<br>




      </small></span><span class="postbody"></span>
      
      
      
      
      <pre>#include &lt;stdio.h&gt;<br><br>#include &lt;stdio.h&gt;<br><br>typedef struct {<br>    char color[10];<br>    double radius;<br>} Ball;<br><br>int main(void) {<br>    Ball ball1 = {"red", 5.0};<br><br>    Ball ball2 = ball1; // 指定運算子'='會複製成員值<br>    ball1.radius = 10.0; // 改變ball1成員值並不會改變ball2成員值<br>    <br>    printf("ball1: %s,\t%.2f\n", ball1.color, ball1.radius);<br>    printf("ball2: %s,\t%.2f\n", ball2.color, ball2.radius);       <br>    <br>    return 0;<br>}<br></pre>




      <span class="postbody"><small><br>




執行結果：<br>




      </small></span>
      
      
      
      
      <table style="text-align: left; width: 100%;" border="0" cellpadding="2" cellspacing="2">




        <tbody>




          <tr>




            <td style="background-color: rgb(0, 0, 0);"><small><span style="color: rgb(255, 255, 255);">ball1: red,&nbsp;&nbsp;&nbsp;&nbsp; 10.00<br>




ball2: red,&nbsp;&nbsp;&nbsp;&nbsp; 5.00</span></small><span style="color: rgb(255, 255, 255);"><br>







            </span></td>




          </tr>




        
        
        
        
        </tbody>
      
      
      
      
      </table>




      <br>




      <span class="postbody"><small>同樣的道理，如果在函式的引數傳遞時，同樣也是將struct的成員值一個一個「複製」給函式上的參數，例如：<br>




      </small></span><span class="postbody"></span>
      
      
      
      
      <pre>#include &lt;stdio.h&gt;<br><br>typedef struct {<br>    char color[10];<br>    double radius;<br>} Ball;<br><br>void foo(Ball);<br><br>int main(void) {<br>    Ball ball = {"red", 5.0};<br><br>    foo(ball);<br>    printf("ball: %s,\t%.2f\n", ball.color, ball.radius);<br>    <br>    return 0;<br>}<br><br>void foo(Ball ball) { // ball 成員值被複製過來 <br>     ball.radius = 100.0;<br>}</pre>




      <span class="postbody"><br>




      <small>在程式的foo()呼叫中，將ball傳遞給foo()上的參數，並在foo()中改變radius，但由於是複製成員值，這並不影響main()當中的ball實例之成員值。<br>




      <br>




在struct中，也可以再宣告struct，例如：<br>




      </small></span>
      
      
      
      
      <div style="margin-left: 40px;"><span style="font-family: Courier New,Courier,monospace; font-weight: bold;" class="postbody"><small>struct Student {</small></span><br style="font-family: Courier New,Courier,monospace; font-weight: bold;">




      <span style="font-family: Courier New,Courier,monospace; font-weight: bold;" class="postbody"><small>&nbsp;&nbsp;&nbsp; char *name;</small></span><br style="font-family: Courier New,Courier,monospace; font-weight: bold;">




      <span style="font-family: Courier New,Courier,monospace; font-weight: bold;" class="postbody"><small>&nbsp;&nbsp;&nbsp; int number;</small></span><br style="font-family: Courier New,Courier,monospace; font-weight: bold;">




      <span style="font-family: Courier New,Courier,monospace; font-weight: bold;" class="postbody"><small>&nbsp;&nbsp;&nbsp; </small></span><br style="font-family: Courier New,Courier,monospace; font-weight: bold;">




      <span style="font-family: Courier New,Courier,monospace; font-weight: bold;" class="postbody"><small>&nbsp;&nbsp;&nbsp; struct {</small></span><br style="font-family: Courier New,Courier,monospace; font-weight: bold;">




      <span style="font-family: Courier New,Courier,monospace; font-weight: bold;" class="postbody"><small>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; char *color;</small></span><br style="font-family: Courier New,Courier,monospace; font-weight: bold;">




      <span style="font-family: Courier New,Courier,monospace; font-weight: bold;" class="postbody"><small>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; double radius;</small></span><br style="font-family: Courier New,Courier,monospace; font-weight: bold;">




      <span style="font-family: Courier New,Courier,monospace; font-weight: bold;" class="postbody"><small>&nbsp;&nbsp;&nbsp; } ball;</small></span><br style="font-family: Courier New,Courier,monospace; font-weight: bold;">




      <span style="font-family: Courier New,Courier,monospace; font-weight: bold;" class="postbody"><small>};</small></span><br style="font-family: Courier New,Courier,monospace; font-weight: bold;">




      <span style="font-family: Courier New,Courier,monospace; font-weight: bold;" class="postbody"></span><br style="font-family: Courier New,Courier,monospace; font-weight: bold;">




      <span style="font-family: Courier New,Courier,monospace; font-weight: bold;" class="postbody"><small>struct Student student1;</small></span><br style="font-family: Courier New,Courier,monospace; font-weight: bold;">




      <span style="font-family: Courier New,Courier,monospace; font-weight: bold;" class="postbody"><small>student1.name = "caterpillar";</small></span><br style="font-family: Courier New,Courier,monospace; font-weight: bold;">




      <span style="font-family: Courier New,Courier,monospace; font-weight: bold;" class="postbody"><small>student1.number = 1;</small></span><br style="font-family: Courier New,Courier,monospace; font-weight: bold;">




      <span style="font-family: Courier New,Courier,monospace; font-weight: bold;" class="postbody"><small>student1.ball.color = "red";</small></span><br style="font-family: Courier New,Courier,monospace; font-weight: bold;">




      <span style="font-family: Courier New,Courier,monospace; font-weight: bold;" class="postbody"><small>student1.ball.radius = 5.0;</small></span><br>




      <span class="postbody"></span></div>




      <span class="postbody"><br>




      <small>您也可以看到，定義struct時，不一定要定義struct名稱，而可以直接在定義結構之後，直接宣告實例。<br>




      </small><br>











      </span> </td>












      <td style="width: 250px; text-align: center; vertical-align: top;"><comment title=" adsense for content" xmlns="http://disruptive-innovations.com/zoo/nvu"></comment>&nbsp;
      
      
      
      
      
      
      <script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
      </script>
      
      
      
      
      
      
      <script type="text/javascript" src="../../../pagead2.googlesyndication.com/pagead/show_ads.js">
      </script><br>







      <comment title=" adsense for content end" xmlns="http://disruptive-innovations.com/zoo/nvu"></comment><br>







      <comment title=" adsense for content" xmlns="http://disruptive-innovations.com/zoo/nvu"></comment>
      
      
      
      
      
      
      <script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->&#160;</script>&nbsp;
      
      
      
      
      
      
      <script type="text/javascript" src="../../../pagead2.googlesyndication.com/pagead/show_ads.js"></script><comment title=" adsense for content end" xmlns="http://disruptive-innovations.com/zoo/nvu"></comment><br>







      <br>






      
      
      
       <script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
      </script>
      <script type="text/javascript" src="../../../pagead2.googlesyndication.com/pagead/show_ads.js">
      </script><br>
      <br>
      
      
      <center>
      
      
      
      
      
      
       <br>







      </center>







 </td>












    </tr>












  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>












<br>











<span class="postbody"><br>












<br>












</span>
<script src="../../../www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-143766-1";
urchinTracker();
</script>
</body>

<!-- Mirrored from openhome.cc/Gossip/CGossip/StructABC.html by HTTrack Website Copier/3.x [XR&CO'2008], Sun, 28 Jul 2013 09:08:06 GMT -->
</html>
