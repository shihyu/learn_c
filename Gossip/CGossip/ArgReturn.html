<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>

<!-- Mirrored from openhome.cc/Gossip/CGossip/ArgReturn.html by HTTrack Website Copier/3.x [XR&CO'2008], Sun, 28 Jul 2013 09:08:06 GMT -->
<head>











  
  
  
  
  
  
  
  
  
  
  <link rel="stylesheet" href="css/stdlayout.css" type="text/css">











  
  
  
  
  
  
  
  
  
  
  <link rel="stylesheet" href="css/print.css" type="text/css">











  
  
  
  
  
  
  
  
  
  
  <meta content="text/html; charset=Big5" http-equiv="content-type">










  
  
  
  
  
  
  
  
  
  
  <title>引數傳遞、傳回值</title>
</head>


<body>











<h3><a href="../index.html">From
Gossip@Openhome</a></h3>











<h1><a href="index.html">C&nbsp;Gossip: 引數傳遞、傳回值</a></h1>











<table style="text-align: left; width: 946px; height: 32px;" border="0" cellpadding="0" cellspacing="0">











  <tbody>











    <tr>











      <td style="width: 676px; vertical-align: top;"> <small>

引數傳遞時的傳值就是傳送（變數）值給函式上對應的參數，值被複製一份給參數，傳遞者與接受者兩個變數彼此各佔有一個記憶體，互不相干，例如： <br>




      </small>
      
      
      
      <div style="margin-left: 40px;"><small><span style="font-family: Courier New,Courier,monospace; font-weight: bold;">int
main(void) { </span><br style="font-family: Courier New,Courier,monospace; font-weight: bold;">




      <span style="font-family: Courier New,Courier,monospace; font-weight: bold;">
&nbsp; &nbsp; int x = 10; </span><br style="font-family: Courier New,Courier,monospace; font-weight: bold;">




      <span style="font-family: Courier New,Courier,monospace; font-weight: bold;">
&nbsp; &nbsp; .... </span><br style="font-family: Courier New,Courier,monospace; font-weight: bold;">




      <span style="font-family: Courier New,Courier,monospace; font-weight: bold;">&nbsp; &nbsp; printf("%d\n", increment(x));</span><br style="font-family: Courier New,Courier,monospace; font-weight: bold;">




      <span style="font-family: Courier New,Courier,monospace; font-weight: bold;"></span></small><small><span style="font-family: Courier New,Courier,monospace; font-weight: bold;">&nbsp; &nbsp; printf("%d\n",&nbsp;x);</span></small><small><span style="font-family: Courier New,Courier,monospace; font-weight: bold;"></span><br style="font-family: Courier New,Courier,monospace; font-weight: bold;">




      <br style="font-family: Courier New,Courier,monospace; font-weight: bold;">




      <span style="font-family: Courier New,Courier,monospace; font-weight: bold;">
&nbsp; &nbsp; return 0; </span><br style="font-family: Courier New,Courier,monospace; font-weight: bold;">




      <span style="font-family: Courier New,Courier,monospace; font-weight: bold;">
} </span><br style="font-family: Courier New,Courier,monospace; font-weight: bold;">




      <br style="font-family: Courier New,Courier,monospace; font-weight: bold;">




      <span style="font-family: Courier New,Courier,monospace; font-weight: bold;">
int increment(int n) { </span><br style="font-family: Courier New,Courier,monospace; font-weight: bold;">




      <span style="font-family: Courier New,Courier,monospace; font-weight: bold;">
&nbsp; &nbsp; n = n + 1; </span><br style="font-family: Courier New,Courier,monospace; font-weight: bold;">




      <span style="font-family: Courier New,Courier,monospace; font-weight: bold;">
&nbsp; &nbsp; return n; </span><br style="font-family: Courier New,Courier,monospace; font-weight: bold;">




      <span style="font-family: Courier New,Courier,monospace; font-weight: bold;">
}</span><br>




      </small></div>



      <small>
      <span style="font-style: italic;"><span style="font-weight: bold;"><br>




      </span></span>
在這個程式片段中，x將值傳遞給increment()函式的參數n，n雖然作了遞增運算，但是對x的儲存值並無影響，x最後仍是顯示10。 <br>


      <br>


      </small><small>

在傳值應用上，您也可以將變數的記憶體位址值取出，傳遞</small><small>位址值</small><small>給指定的指標參數，只要使用&amp;運算子就可以了。<br>




      </small>
      
      
      
      <div style="margin-left: 40px;"><small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">int
main(void) { </span><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">




      <span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp;
&nbsp; int
x = 10; </span><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">




      <span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp;
&nbsp; ....
      </span><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">




      <span style="font-weight: bold; font-family: Courier New,Courier,monospace;"></span></small><small><span style="font-family: Courier New,Courier,monospace; font-weight: bold;">&nbsp; &nbsp; printf("%d\n", increment(&amp;x));</span><br style="font-family: Courier New,Courier,monospace; font-weight: bold;">




      <span style="font-family: Courier New,Courier,monospace; font-weight: bold;"></span></small><small><span style="font-family: Courier New,Courier,monospace; font-weight: bold;">&nbsp; &nbsp; printf("%d\n",&nbsp;x);</span></small><small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;"></span><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp;</span><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">




      <br style="font-weight: bold; font-family: Courier New,Courier,monospace;">




      <span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp;
&nbsp;
return 0; </span><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">




      <span style="font-weight: bold; font-family: Courier New,Courier,monospace;">}
      </span><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">




      <br style="font-weight: bold; font-family: Courier New,Courier,monospace;">




      <span style="font-weight: bold; font-family: Courier New,Courier,monospace;">int
increment(int
*n) { </span><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">




      <span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp;
&nbsp; *n =
*n + 1; </span><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">




      <span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp;
&nbsp;
return *n; </span><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">




      <span style="font-weight: bold; font-family: Courier New,Courier,monospace;">}</span><br>




      </small></div>



      <small>
      <br>




在這個程式中，increment()上的參數n是個指標，在呼叫increment()函式時，您使用取址運算子&amp;將x變數的記憶體位
址取出並
傳遞給指標n，而在函式中，您使用取值運算子*取出這塊記憶體位址的值，並作遞增動作之後再指定回該記憶體位址，所以程式最後的x變數會顯示值11。 <br>




      <br>




在函式上宣告指標參數的目的，通常目的是若作為引數的變數值同一位址上，在函式中若有變動該位址上的值時，呼叫者也可以保留這份變動的結果，這可以解決一
個問題，在C中我們在呼叫函式後只能傳回
（return）一個值，若在呼叫函式時，您希望能取得兩個以上的運算結果，就可以使用指標參數。<br>


      <br>


      </small><small>
在定義函式時，一定要定義函式的傳回值型態，如果函式不傳回值，則使用void表示不傳回任何數值；一旦指定函式的傳回值不為void，則在函式中一定要
使用return傳回一個數值，否則編譯器將回報錯誤。 <br>




      <br>





在之前的範例中，您只是使用傳值的方式傳回函式的執行結果，事實上您也可以傳回一個指標或是參考，傳回指標通常意味著您要對這個指標所指向的記憶體位置作
取值或更動的動作，例如下面的程式中，您在函式中動態建立一個陣列，並傳回它的指標值： <br>


      </small>
      
      
      <pre>#include &lt;stdio.h&gt;<br>#include &lt;stdlib.h&gt;<br><br>int* createArray(int);<br>void deleteArray(int*);<br><br>int main(void) {<br>    int m = 0; <br><br>    printf("陣列大小: "); <br>    scanf("%d", &amp;m);<br><br>    int *arr = createArray(m); <br>    int i;<br>    for(i = 0; i &lt; m; i++) {<br>        arr[i] = i; <br>    }<br> <br>    for(i = 0; i &lt; m; i++) {<br>        printf("arr[%d] = %d\n", i, arr[i]);<br>    }<br><br>    deleteArray(arr);<br>    <br>    return 0;<br>}<br><br>// 傳回建立的陣列位址<br>int* createArray(int m) { <br>    int *a = malloc(m * sizeof(int)); <br><br>    int i;<br>    for(i = 0; i &lt; m; i++) {<br>        a[i] = 0; <br>    }<br><br>    return a; <br>}<br><br>void deleteArray(int* arr) {<br>    free(arr);<br>}</pre>










      <span class="postbody"><br>


      </span><span class="postbody"><small>
執行結果：</small></span><br>





      
      
      
      
      <table style="text-align: left; width: 100%;" border="0" cellpadding="2" cellspacing="2">





        <tbody>





          <tr>





            <td style="background-color: rgb(0, 0, 0);"><small><span style="color: rgb(255, 255, 255);">陣列大小: 5<br>





arr[0] = 0<br>





arr[1] = 1<br>





arr[2] = 2<br>





arr[3] = 3<br>





arr[4] = 4</span></small><span style="color: rgb(255, 255, 255);"><br>





            </span></td>





          </tr>





        
        
        
        
        </tbody>
      
      
      
      
      </table>





      <br>




      <small>由於您使用動態配置的方式，所以在使用free()之前，這塊被配置的記憶體並不會自動清除，所以您可以直接傳回給呼
叫函式的主函式，注意如果您不是使用malloc()來配置，則在副函式中所宣告的變數記憶體，在函式執行結束後都會自動消失，則您傳回指標值也就沒有意
義，也會造成存取錯誤，因為該塊記憶體在副函式
執行完畢後已經自動回收了。 <br>




      <br>





在這邊的範例您也看到了如何傳遞陣列給函式，以及如何傳回一個陣列，在C中傳遞陣列或傳回陣列一律使用傳遞記憶體位址的方法，因為陣列名稱本身就是個指標，儲存有
位址資訊。<br>


      <br>


      </small><small>


必須注意的是，函式中的區域變數在函式開始時被配置，在函式結束後所佔有的記憶體位址也會被清除，絕對不要傳回一個區域變數的位址給呼叫者，因為您所存取的記憶體位址中資料是未知的，所以結果是不可預期的。</small><br>

      <span class="postbody"><br>










      </span> </td>











      <td style="width: 250px; text-align: center; vertical-align: top;"><comment title=" adsense for content" xmlns="http://disruptive-innovations.com/zoo/nvu"></comment>&nbsp;
      
      
      
      
      
      
      <script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
      </script>
      
      
      
      
      
      
      <script type="text/javascript" src="../../../pagead2.googlesyndication.com/pagead/show_ads.js">
      </script><br>







      <comment title=" adsense for content end" xmlns="http://disruptive-innovations.com/zoo/nvu"></comment><br>







      <comment title=" adsense for content" xmlns="http://disruptive-innovations.com/zoo/nvu"></comment>
      
      
      
      
      
      
      <script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->&#160;</script>&nbsp;
      
      
      
      
      
      
      <script type="text/javascript" src="../../../pagead2.googlesyndication.com/pagead/show_ads.js"></script><comment title=" adsense for content end" xmlns="http://disruptive-innovations.com/zoo/nvu"></comment><br>







      <br>






      
      
      
      
      
      
      <center>
      
      
      
      
      
      
      <script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
</script>
<script type="text/javascript" src="../../../pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<br>







      </center>







 </td>











    </tr>











  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>











<br>










<span class="postbody"><br>











<br>











</span>
<script src="../../../www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-143766-1";
urchinTracker();
</script>
</body>

<!-- Mirrored from openhome.cc/Gossip/CGossip/ArgReturn.html by HTTrack Website Copier/3.x [XR&CO'2008], Sun, 28 Jul 2013 09:08:06 GMT -->
</html>
